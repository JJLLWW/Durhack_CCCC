{% extends "layout.html" %}

{% block title %}
    Chatting
{% endblock %}

{% block main %}
    <div class="chatbox">
        <br>
        Your conversation:
        <br>
        <textarea id="currentConvo" name="currentConvo" cols="100"></textarea>
        </textarea>
    </div>
    <br>
    <label for="newMessage">Input your message:</label>
    <form action="/sendMessage" method="post">
        <div>
            <textarea style="resize:none" id="newMessage" name="newMessage" rows="4" cols="50" autofocus placeholder="Enter your message here...">
            </textarea>
        </div>
        <button class="btn btn-success" type="submit" id="btn-msg">Send</button>
    </form>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
    <script>
    console.log("asjdjksabdjkb")
    const socket = io.connect("http://127.0.0.1:5000/");

    socket.on("connect", function () {
        socket.emit('join_chat')
    });

    var btn = document.getElementById("btn-msg");
    btn.addEventListener("click", function() {
        console.log("button clicked")
        var msg_txt = document.getElementById("newMessage").value
        socket.emit('msg_sent', {message: msg_txt})
    })
    </script>
{% endblock %}